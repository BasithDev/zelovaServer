import{r as f,P as h,j as e,b6 as oe,G as $e,a as Fe,u as Te,ai as X,C as Ie,m as g,a7 as De,aS as Me,bh as Ze,bi as we,bj as re,bk as Ue,bl as Qe,b8 as Be,b2 as He,bm as Ye,bn as Le,bb as We,bc as Ge,bo as Ce,E as ie}from"./index-CayrqlUJ.js";import{a as Ve}from"./index-DujuKZwk.js";const Ee=s=>{const t=s.itemPrice*s.quantity,r=s.item.offers;if(r&&s.quantity>=r.requiredQuantity){const n=t*r.discountAmount/100;return{original:t,discounted:t-n,hasDiscount:!0}}return{original:t,discounted:t,hasDiscount:!1}},Je=s=>s!=null&&s.items?s.items.reduce((t,r)=>{const n=Ee(r);return t+n.discounted},0):0,Xe=(s,t)=>{const[r,n]=f.useState({coupons:[],showCoupons:!1,couponCode:"",appliedCoupon:null,couponError:"",showAddresses:!1,selectedAddress:"",deliveryAddress:s,phoneNumber:t,isUsingCurrentLocation:!1});return[r,i=>{n(o=>({...o,...i}))}]},ke=({restaurant:s=null})=>s?e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden mb-4 sm:mb-6",children:[e.jsxs("div",{className:"h-24 sm:h-32 bg-gradient-to-br from-orange-500 via-orange-400 to-yellow-400 relative",children:[e.jsx("div",{className:"absolute inset-0",children:e.jsxs("svg",{className:"w-full h-full opacity-10",viewBox:"0 0 100 100",preserveAspectRatio:"none",children:[e.jsx("path",{d:"M0 0 L100 0 L100 100 L0 100 Z",fill:"url(#pattern)"}),e.jsx("defs",{children:e.jsx("pattern",{id:"pattern",x:"0",y:"0",width:"10",height:"10",patternUnits:"userSpaceOnUse",children:e.jsx("circle",{cx:"5",cy:"5",r:"2",fill:"currentColor"})})})]})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-16 bg-gradient-to-t from-white/30"})]}),e.jsx("div",{className:"p-4 sm:p-6 relative",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start gap-4 sm:gap-6",children:[e.jsx("div",{className:"w-20 h-20 sm:w-24 sm:h-24 rounded-lg overflow-hidden shadow-lg -mt-12 border-4 border-white bg-white mx-auto sm:mx-0",children:e.jsx("img",{src:s==null?void 0:s.image,alt:s==null?void 0:s.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 text-center sm:text-left",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-800",children:s==null?void 0:s.name}),e.jsx("div",{className:"flex items-center justify-center sm:justify-start gap-2 mt-2",children:e.jsx("div",{className:"bg-green-100 px-3 py-1 rounded-lg",children:e.jsx("span",{className:"text-green-700 text-sm font-medium",children:"Open"})})}),e.jsxs("p",{className:"text-sm sm:text-base text-gray-600 mt-2",children:[e.jsx("span",{className:"hidden sm:inline-flex items-center gap-2",children:e.jsx(oe,{className:"text-orange-500"})}),s==null?void 0:s.address]})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center sm:justify-start gap-2 mt-3",children:[e.jsx("span",{className:"bg-orange-50 text-orange-600 text-xs sm:text-sm px-3 py-1 rounded-full",children:"Fast Food"}),e.jsx("span",{className:"bg-orange-50 text-orange-600 text-xs sm:text-sm px-3 py-1 rounded-full",children:"Burgers"}),e.jsx("span",{className:"bg-orange-50 text-orange-600 text-xs sm:text-sm px-3 py-1 rounded-full",children:"Beverages"})]})]})]})})]}):null;ke.propTypes={restaurant:h.shape({name:h.string,address:h.string,image:h.string})};function Ke(s){return $e({tag:"svg",attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12 0A12 12 0 0 0 0 12a12.013 12.013 0 0 0 12 12 12 12 0 1 0 0-24zm-1.008 4.418h2.014v2.014l3.275-.002v1.826l-5.08 6.889h5.08v2.423h-3.275v2.006h-2.012v-2.006H7.72v-1.826l5.074-6.888H7.719V6.432h3.273V4.418z"},child:[]}]})(s)}let es={data:""},ss=s=>typeof window=="object"?((s?s.querySelector("#_goober"):window._goober)||Object.assign((s||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:s||es,ts=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,as=/\/\*[^]*?\*\/|  +/g,Ae=/\n+/g,z=(s,t)=>{let r="",n="",d="";for(let i in s){let o=s[i];i[0]=="@"?i[1]=="i"?r=i+" "+o+";":n+=i[1]=="f"?z(o,i):i+"{"+z(o,i[1]=="k"?"":t)+"}":typeof o=="object"?n+=z(o,t?t.replace(/([^,])+/g,m=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,x=>/&/.test(x)?x.replace(/&/g,m):m?m+" "+x:x)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),d+=z.p?z.p(i,o):i+":"+o+";")}return r+(t&&d?t+"{"+d+"}":d)+n},q={},Se=s=>{if(typeof s=="object"){let t="";for(let r in s)t+=r+Se(s[r]);return t}return s},rs=(s,t,r,n,d)=>{let i=Se(s),o=q[i]||(q[i]=(x=>{let b=0,C=11;for(;b<x.length;)C=101*C+x.charCodeAt(b++)>>>0;return"go"+C})(i));if(!q[o]){let x=i!==s?s:(b=>{let C,v,A=[{}];for(;C=ts.exec(b.replace(as,""));)C[4]?A.shift():C[3]?(v=C[3].replace(Ae," ").trim(),A.unshift(A[0][v]=A[0][v]||{})):A[0][C[1]]=C[2].replace(Ae," ").trim();return A[0]})(s);q[o]=z(d?{["@keyframes "+o]:x}:x,r?"":"."+o)}let m=r&&q.g?q.g:null;return r&&(q.g=q[o]),((x,b,C,v)=>{v?b.data=b.data.replace(v,x):b.data.indexOf(x)===-1&&(b.data=C?x+b.data:b.data+x)})(q[o],t,n,m),o},is=(s,t,r)=>s.reduce((n,d,i)=>{let o=t[i];if(o&&o.call){let m=o(r),x=m&&m.props&&m.props.className||/^go/.test(m)&&m;o=x?"."+x:m&&typeof m=="object"?m.props?"":z(m,""):m===!1?"":m}return n+d+(o??"")},"");function ee(s){let t=this||{},r=s.call?s(t.p):s;return rs(r.unshift?r.raw?is(r,[].slice.call(arguments,1),t.p):r.reduce((n,d)=>Object.assign(n,d&&d.call?d(t.p):d),{}):r,ss(t.target),t.g,t.o,t.k)}let Re,le,de;ee.bind({g:1});let O=ee.bind({k:1});function ns(s,t,r,n){z.p=t,Re=s,le=r,de=n}function _(s,t){let r=this||{};return function(){let n=arguments;function d(i,o){let m=Object.assign({},i),x=m.className||d.className;r.p=Object.assign({theme:le&&le()},m),r.o=/ *go\d+/.test(x),m.className=ee.apply(r,n)+(x?" "+x:"");let b=s;return s[0]&&(b=m.as||s,delete m.as),de&&b[0]&&de(m),Re(b,m)}return d}}var os=s=>typeof s=="function",ce=(s,t)=>os(s)?s(t):s,ls=(()=>{let s=0;return()=>(++s).toString()})(),ds=(()=>{let s;return()=>{if(s===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");s=!t||t.matches}return s}})(),cs=20,K=new Map,ms=1e3,Pe=s=>{if(K.has(s))return;let t=setTimeout(()=>{K.delete(s),se({type:4,toastId:s})},ms);K.set(s,t)},xs=s=>{let t=K.get(s);t&&clearTimeout(t)},me=(s,t)=>{switch(t.type){case 0:return{...s,toasts:[t.toast,...s.toasts].slice(0,cs)};case 1:return t.toast.id&&xs(t.toast.id),{...s,toasts:s.toasts.map(i=>i.id===t.toast.id?{...i,...t.toast}:i)};case 2:let{toast:r}=t;return s.toasts.find(i=>i.id===r.id)?me(s,{type:1,toast:r}):me(s,{type:0,toast:r});case 3:let{toastId:n}=t;return n?Pe(n):s.toasts.forEach(i=>{Pe(i.id)}),{...s,toasts:s.toasts.map(i=>i.id===n||n===void 0?{...i,visible:!1}:i)};case 4:return t.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(i=>i.id!==t.toastId)};case 5:return{...s,pausedAt:t.time};case 6:let d=t.time-(s.pausedAt||0);return{...s,pausedAt:void 0,toasts:s.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+d}))}}},us=[],ne={toasts:[],pausedAt:void 0},se=s=>{ne=me(ne,s),us.forEach(t=>{t(ne)})},ps=(s,t="blank",r)=>({createdAt:Date.now(),visible:!0,type:t,ariaProps:{role:"status","aria-live":"polite"},message:s,pauseDuration:0,...r,id:(r==null?void 0:r.id)||ls()}),W=s=>(t,r)=>{let n=ps(t,s,r);return se({type:2,toast:n}),n.id},w=(s,t)=>W("blank")(s,t);w.error=W("error");w.success=W("success");w.loading=W("loading");w.custom=W("custom");w.dismiss=s=>{se({type:3,toastId:s})};w.remove=s=>se({type:4,toastId:s});w.promise=(s,t,r)=>{let n=w.loading(t.loading,{...r,...r==null?void 0:r.loading});return s.then(d=>(w.success(ce(t.success,d),{id:n,...r,...r==null?void 0:r.success}),d)).catch(d=>{w.error(ce(t.error,d),{id:n,...r,...r==null?void 0:r.error})}),s};var hs=O`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,gs=O`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,fs=O`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,ys=_("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${s=>s.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${hs} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${gs} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${s=>s.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${fs} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,bs=O`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,js=_("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${s=>s.secondary||"#e0e0e0"};
  border-right-color: ${s=>s.primary||"#616161"};
  animation: ${bs} 1s linear infinite;
`,vs=O`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Ns=O`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,ws=_("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${s=>s.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${vs} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Ns} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${s=>s.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Cs=_("div")`
  position: absolute;
`,As=_("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Ps=O`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Fs=_("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Ps} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Es=({toast:s})=>{let{icon:t,type:r,iconTheme:n}=s;return t!==void 0?typeof t=="string"?f.createElement(Fs,null,t):t:r==="blank"?null:f.createElement(As,null,f.createElement(js,{...n}),r!=="loading"&&f.createElement(Cs,null,r==="error"?f.createElement(ys,{...n}):f.createElement(ws,{...n})))},ks=s=>`
0% {transform: translate3d(0,${s*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Ss=s=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${s*-150}%,-1px) scale(.6); opacity:0;}
`,Rs="0%{opacity:0;} 100%{opacity:1;}",qs="0%{opacity:1;} 100%{opacity:0;}",Os=_("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,zs=_("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,_s=(s,t)=>{let r=s.includes("top")?1:-1,[n,d]=ds()?[Rs,qs]:[ks(r),Ss(r)];return{animation:t?`${O(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${O(d)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}};f.memo(({toast:s,position:t,style:r,children:n})=>{let d=s.height?_s(s.position||t||"top-center",s.visible):{opacity:0},i=f.createElement(Es,{toast:s}),o=f.createElement(zs,{...s.ariaProps},ce(s.message,s));return f.createElement(Os,{className:s.className,style:{...d,...r,...s.style}},typeof n=="function"?n({icon:i,message:o}):f.createElement(f.Fragment,null,i,o))});ns(f.createElement);ee`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`;const qe=({isOpen:s,onClose:t,items:r,totalAmount:n,tax:d,platformFee:i,appliedCoupon:o,totalSavings:m,isFreeDelivery:x,deliveryFee:b,offerSavings:C,selectedAddress:v,selectedPhoneNumber:A,restaurantId:te,cartId:F})=>{const[k,Q]=f.useState("COD"),[D,c]=f.useState(!1),[M,Z]=f.useState(0),R=n+b+d+i-((o==null?void 0:o.discountAmount)||0),B=Fe(),S=Te(),P=X(l=>l.userData.data),u=Ie();f.useEffect(()=>{s&&(async()=>{try{const p=await Me();Z(p.data.zcoins.balance)}catch(p){console.error("Error fetching coin balance:",p)}})()},[s]);const $=[{id:"COD",name:"Cash on Delivery",icon:e.jsx(Ze,{className:"text-xl"}),description:"Pay with cash upon delivery"},{id:"RAZORPAY",name:"RazorPay",icon:e.jsx(Ve,{className:"text-xl"}),description:"Pay securely online"},{id:"ZCOINS",name:"Zcoins",icon:e.jsx(Ke,{className:"text-xl"}),description:"Pay with your Zcoins",disabled:M<R}],G=()=>new Promise(l=>{const p=document.createElement("script");p.src="https://checkout.razorpay.com/v1/checkout.js",p.onload=()=>l(!0),p.onerror=()=>l(!1),document.body.appendChild(p)}),H=l=>({user:{name:P==null?void 0:P.fullname,phoneNumber:A,address:v},restaurantId:te._id,cartId:F,couponCode:o?o.code:null,items:r.map(p=>{var j;return{name:p.item.name,quantity:p.quantity,price:p.itemPrice,totalPrice:p.itemPrice*p.quantity,customizations:((j=p.selectedCustomizations)==null?void 0:j.map(T=>({fieldName:T.fieldName,selectedOption:T.options})))||[]}}),billDetails:{itemTotal:n,platformFee:i,deliveryFee:x?0:b,tax:d,discount:o?o.discountAmount:0,offerSavings:C,totalSavings:m,finalAmount:R,paymentMethod:l}}),N=async()=>{var l;try{if(c(!0),!await G()){w.error("Failed to load payment gateway");return}const j=await Ue({amount:R});if(!((l=j.data)!=null&&l.success)){w.error("Failed to create order");return}const T=H("RAZORPAY"),ae={key:"rzp_test_WC4CawFnZYSm79",amount:j.data.order.amount,currency:j.data.order.currency,name:"Zelova",description:"Food Order Payment",order_id:j.data.order.id,handler:async function(Y){var J;try{const I=await Qe({razorpay_order_id:Y.razorpay_order_id,razorpay_payment_id:Y.razorpay_payment_id,razorpay_signature:Y.razorpay_signature,orderDetails:T});(J=I.data)!=null&&J.success?(w.success("Payment successful!"),S(re()),u.invalidateQueries(["cart"]),u.invalidateQueries(["totalItems"]),u.invalidateQueries(["totalPrice"]),B("/order-success",{state:{orderId:I.data.order.orderId,coinsWon:I.data.coinsEarned}}),t()):w.error("Payment verification failed")}catch(I){console.error("Error verifying payment:",I),w.error("Payment verification failed")}},prefill:{name:P==null?void 0:P.fullname,email:P==null?void 0:P.email,contact:A},config:{display:{blocks:{otpEmail:{name:"Pay using Email OTP",instruments:[{method:"otp",channels:["email"],value:P==null?void 0:P.email}]},otpSMS:{name:"Pay using SMS OTP",instruments:[{method:"otp",channels:["sms"],value:A}]}},sequence:["block.otpEmail","block.otpSMS"],preferences:{show_default_blocks:!0}}},modal:{ondismiss:function(){c(!1)},confirm_close:!0,escape:!1},theme:{color:"#f97316"},retry:{enabled:!0,max_count:3},notes:{email:P==null?void 0:P.email,phoneNumber:A},method:["card","netbanking","upi"]};new window.Razorpay(ae).open()}catch(p){console.error("Error during payment:",p),w.error("Payment failed. Please try again.")}finally{c(!1)}},V=async()=>{if(!(A!=null&&A.trim())){w.error("Please enter a phone number before proceeding");return}const l=k==="ZCOINS"?Math.ceil(R):R,p=H(k);if(p.billDetails.finalAmount=l,k==="ZCOINS"){if(M<l){w.error("Insufficient Zcoins balance");return}try{c(!0);const j=await we(p);S(re()),u.invalidateQueries(["cart"]),u.invalidateQueries(["totalItems"]),u.invalidateQueries(["totalPrice"]),u.invalidateQueries(["zcoins"]),B("/order-success",{state:{orderId:j.data.order.orderId,coinsWon:j.data.coinsEarned}}),t()}catch(j){console.error("Error placing order:",j),w.error("Failed to place order")}finally{c(!1)}return}if(k==="COD")try{c(!0);const j=await we(p);S(re()),u.invalidateQueries(["cart"]),u.invalidateQueries(["totalItems"]),u.invalidateQueries(["totalPrice"]),B("/order-success",{state:{orderId:j.data.order.orderId,coinsWon:j.data.coinsEarned}}),t()}catch(j){console.error("Error placing order:",j),w.error("Failed to place order")}finally{c(!1)}else k==="RAZORPAY"&&N()};return s?e.jsx(g.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:t,children:e.jsxs(g.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",duration:.3},className:"bg-white rounded-xl shadow-2xl w-full max-w-6xl p-6 max-h-[90vh] overflow-y-auto",onClick:l=>l.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Confirm Order"}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(De,{className:"text-gray-500"})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-600 mb-2",children:"Total Amount to Pay"}),e.jsxs("div",{className:"text-5xl font-bold",children:["₹",R.toFixed(2)]}),m>0&&e.jsxs("p",{className:"text-green-600 text-sm mt-2",children:["You saved ₹",m.toFixed(2)," on this order!"]}),e.jsxs("p",{className:"text-md text-gray-800 mt-2",children:["Your Zcoin Balance: ",e.jsx("span",{className:"font-bold",children:M})," coins"]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-3",children:"Order Summary"}),e.jsxs("div",{className:"space-y-2",children:[r.map(l=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:[l.item.name," x ",l.quantity]}),e.jsxs("span",{className:"font-medium",children:["₹",(l.itemPrice*l.quantity).toFixed(2)]})]},l._id)),e.jsxs("div",{className:"border-t border-gray-200 my-2 pt-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Platform Fee"}),e.jsxs("span",{className:"font-medium",children:["₹",i.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Tax"}),e.jsxs("span",{className:"font-medium",children:["₹",d.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-600",children:"Delivery Fee"}),x&&e.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full",children:"Free Delivery"})]}),e.jsx("span",{className:"flex items-center gap-2",children:x?e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-gray-400 line-through",children:["₹",b.toFixed(2)]}),e.jsx("span",{className:"text-green-600",children:"FREE"})]}):`₹${b.toFixed(2)}`})]}),C>0&&e.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[e.jsx("span",{children:"Offer Discount"}),e.jsxs("span",{children:["-₹",C.toFixed(2)]})]}),o&&e.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[e.jsxs("span",{children:["Coupon Discount (",o.code,")"]}),e.jsxs("span",{children:["-₹",o.discountAmount.toFixed(2)]})]})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-gray-700",children:"Select Payment Method"}),$.map(l=>e.jsx("div",{onClick:()=>!l.disabled&&Q(l.id),className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${k===l.id?"border-orange-400 bg-orange-50":l.disabled?"border-gray-200 bg-gray-50 opacity-60 cursor-not-allowed":"border-gray-200 hover:border-orange-400"}`,children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2 rounded-full ${k===l.id?"bg-orange-100 text-orange-600":l.disabled?"bg-gray-100 text-gray-400":"bg-gray-100 text-gray-600"}`,children:l.icon}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-800",children:l.name}),e.jsx("p",{className:"text-sm text-gray-500",children:l.description}),l.disabled&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:"Insufficient coin balance for this order"})]})]})},l.id))]}),e.jsx("button",{onClick:V,disabled:D,className:`w-full py-4 rounded-lg text-white font-medium transition-all ${D?"bg-gray-400 cursor-not-allowed":"bg-orange-500 hover:bg-primary/90"}`,children:D?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Processing..."]}):`Confirm Order - ₹${R.toFixed(2)}`})]})]})]})}):null};qe.propTypes={isOpen:h.bool.isRequired,onClose:h.func.isRequired,items:h.arrayOf(h.shape({_id:h.string.isRequired,item:h.shape({name:h.string.isRequired}).isRequired,quantity:h.number.isRequired,itemPrice:h.number.isRequired})).isRequired,totalAmount:h.number.isRequired,tax:h.number.isRequired,platformFee:h.number.isRequired,appliedCoupon:h.shape({code:h.string.isRequired,discountAmount:h.number.isRequired}),totalSavings:h.number.isRequired,isFreeDelivery:h.bool.isRequired,deliveryFee:h.number.isRequired,offerSavings:h.number.isRequired,selectedAddress:h.string.isRequired,selectedPhoneNumber:h.string.isRequired,restaurantId:h.object.isRequired,cartId:h.string.isRequired};const Is=()=>{var he,ge,fe,ye,be,je,ve,Ne;const s=Fe(),{cart:t,updateCartMutation:r}=Be(),n=X(a=>{var y,E;return(E=(y=a==null?void 0:a.userData)==null?void 0:y.data)==null?void 0:E.phoneNumber}),d=X(a=>{var y;return(y=a==null?void 0:a.userLocation)==null?void 0:y.address}),[i,o]=f.useState({addresses:[]}),[m,x]=f.useState(""),[b,C]=f.useState(""),v=(he=t==null?void 0:t.data)==null?void 0:he.cart,A=(fe=(ge=t==null?void 0:t.data)==null?void 0:ge.cart)==null?void 0:fe.restaurantId,[te,F]=Xe(d,n),{coupons:k,showCoupons:Q,couponCode:D,appliedCoupon:c,couponError:M,showAddresses:Z,deliveryAddress:R,isUsingCurrentLocation:B}=te,[S,P]=f.useState(10),u=X(a=>a==null?void 0:a.userLocation),$=(je=(be=(ye=t==null?void 0:t.data)==null?void 0:ye.cart)==null?void 0:be.restaurantId)==null?void 0:je._id,G=f.useRef(!0),H=f.useCallback(async()=>{var a,y;try{const[E,L,U]=await Promise.all([He(),Ye(),u!=null&&u.coordinates&&$?Le((a=u==null?void 0:u.coordinates)==null?void 0:a.lat,(y=u==null?void 0:u.coordinates)==null?void 0:y.lng,$):Promise.resolve({data:{deliveryFee:10}})]);o((E==null?void 0:E.data)||[]),F({coupons:(L==null?void 0:L.data)||[]}),U&&U.data&&P(U.data.deliveryFee)}catch(E){console.error("Error fetching data:",E)}},[F,u,$]);f.useEffect(()=>{G.current&&(u!=null&&u.coordinates)&&$&&(H(),G.current=!1)},[H,u==null?void 0:u.coordinates,$]);const N=Je(v),V=((ve=v==null?void 0:v.items)==null?void 0:ve.reduce((a,y)=>a+y.itemPrice*y.quantity,0))||0,l=V-N,p=N*.05,j=8,T=(a,y)=>{var U;const E=(U=v==null?void 0:v.items)==null?void 0:U.find(_e=>_e.item._id===a),L={itemId:a,action:y,selectedCustomizations:(E==null?void 0:E.selectedCustomizations)||null};r.mutate(L)},ae=a=>{x(a._id),F({isUsingCurrentLocation:!1,deliveryAddress:a.address,showAddresses:!1})},xe=()=>{F({isUsingCurrentLocation:!0,selectedAddress:"",deliveryAddress:d,showAddresses:!1})},Y=()=>{C(n),F({showAddresses:!1})},J=a=>{F({couponCode:a,showCoupons:!1})},I=()=>{F({couponError:""});const a=k.find(E=>E.code===D);if(!a){F({couponError:"Invalid coupon code"});return}if(N<a.minPrice){F({couponError:`Add items worth ₹${(a.minPrice-N).toFixed(2)} more to apply this coupon`});return}const y=a.type==="percentage"?N*a.discount/100:a.discount;F({appliedCoupon:{...a,discountAmount:y}})},Oe=()=>{F({appliedCoupon:null,couponError:""})},[ue,pe]=f.useState(!1),ze=()=>{pe(!0)};return!v||!v.items||v.items.length===0?e.jsxs(g.div,{className:"flex flex-col justify-center items-center min-h-[70vh]",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsx(g.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:260,damping:20},children:e.jsx(g.img,{src:"/empty-cart.svg",alt:"Empty Cart",className:"w-48 h-48 me-8",animate:{y:[0,-10,0]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},onError:a=>{a.target.src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='9' cy='21' r='1'%3E%3C/circle%3E%3Ccircle cx='20' cy='21' r='1'%3E%3C/circle%3E%3Cpath d='M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6'%3E%3C/path%3E%3C/svg%3E"}})}),e.jsxs(g.div,{className:"flex flex-col items-center space-y-4 mt-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},children:[e.jsx(g.h2,{className:"text-2xl font-semibold text-gray-800",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3,duration:.5},children:"Your Cart is Empty"}),e.jsx(g.p,{className:"text-gray-600",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},children:"Add some delicious items to your cart!"}),e.jsx(g.button,{onClick:()=>s("/"),className:"bg-orange-500 text-white px-8 py-3 rounded-lg hover:bg-orange-600 transition-colors duration-300 transform hover:scale-105 mt-2",whileHover:{scale:1.05},whileTap:{scale:.95},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5,duration:.5},children:"Browse Menu"})]})]}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-6 text-center",children:"Checkout"}),e.jsx(ke,{restaurant:A}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 sm:p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Your Cart"}),e.jsx("ul",{className:"divide-y divide-gray-200",children:v.items.map(a=>e.jsx(g.li,{className:"py-3",initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:e.jsx("div",{className:"flex flex-col space-y-3",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-800 text-lg sm:text-2xl",children:a.item.name}),a.selectedCustomizations&&a.selectedCustomizations.length>0&&e.jsx("div",{className:"mt-1 space-y-1",children:e.jsx("div",{className:"text-sm text-gray-600",children:a.selectedCustomizations.map(y=>e.jsxs("div",{children:["Add-Ons : ",y.fieldName,": ",y.options.name," - ₹",y.options.price]},y._id))})}),a.item.offers&&e.jsx("div",{className:"bg-green-200 text-green-500 font-semibold text-sm sm:text-md py-1 px-2 rounded-md mt-2 w-fit",children:e.jsx("p",{children:a.item.offers.offerName})})]}),e.jsxs("div",{className:"flex justify-between sm:flex-col sm:items-end gap-4",children:[e.jsxs(g.div,{className:"flex items-center bg-orange-50 rounded-lg overflow-hidden h-fit",whileTap:{scale:.98},children:[e.jsx(g.button,{onClick:()=>T(a.item._id,"remove"),className:"px-3 py-2 hover:bg-orange-100 transition-colors",whileHover:{backgroundColor:"rgb(251 146 60 / 0.2)"},whileTap:{scale:.95},children:e.jsx(We,{className:"text-orange-500",size:12})}),e.jsx(g.div,{className:"w-10 flex items-center justify-center font-semibold text-gray-700",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:300},children:a.quantity},a.quantity),e.jsx(g.button,{onClick:()=>T(a.item._id,"add"),className:"px-3 py-2 hover:bg-orange-100 transition-colors",whileHover:{backgroundColor:"rgb(251 146 60 / 0.2)"},whileTap:{scale:.95},children:e.jsx(Ge,{className:"text-orange-500",size:12})})]}),e.jsxs(g.div,{className:"text-right",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:300},children:[e.jsx("div",{className:"font-bold text-gray-800",children:(()=>{const y=Ee(a);return y.hasDiscount?e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("span",{className:"text-gray-400 line-through text-sm",children:["₹",y.original]}),e.jsxs("span",{className:"text-green-600",children:["₹",y.discounted.toFixed(2)]})]}):e.jsxs("span",{children:["₹",y.original]})})()}),e.jsxs("div",{className:"text-xs sm:text-sm text-gray-500",children:["₹",a.item.price," each"]})]},a.itemPrice)]})]})})},a._id))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-3 my-6",children:[e.jsxs("div",{className:"mb-1",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Have a Coupon?"}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("input",{type:"text",value:D,onChange:a=>F({couponCode:a.target.value.toUpperCase()}),placeholder:"Enter coupon code",disabled:c!==null,className:`flex-1 border border-gray-200 rounded-lg px-4 py-2 focus:outline-none ${c?"bg-gray-100 text-gray-500 cursor-not-allowed":"focus:border-orange-500"}`}),c?e.jsx("button",{onClick:Oe,className:"bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-lg font-medium transition-colors",children:"Remove"}):e.jsx("button",{onClick:I,className:"bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 rounded-lg font-medium transition-colors",children:"Apply"})]}),M&&e.jsx("p",{className:"text-red-500 text-sm mb-2",children:M}),e.jsx("div",{className:"relative",children:e.jsxs("button",{onClick:()=>F({showCoupons:!Q}),className:"text-orange-500 hover:text-orange-600 text-sm font-medium flex items-center",children:["View Available Coupons",e.jsx(Ce,{className:`ms-1 transform transition-transform duration-300 ${Q?"rotate-180":""}`,size:12})]})})]}),e.jsx(ie,{children:Q&&e.jsx(g.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{type:"tween",duration:0},className:"overflow-hidden border-t border-gray-100 pt-4 px-4",children:e.jsxs("div",{className:"space-y-3 hide-scrollbar max-h-56 overflow-y-auto",children:[k&&k.map(a=>e.jsx("div",{className:"border border-gray-100 rounded-lg p-3 hover:border-orange-500 transition-colors bg-gray-50",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1 mr-4",children:[e.jsx("h3",{className:"font-medium text-gray-800",children:a.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a.description}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Min. Order: ₹",a.minPrice]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsx("span",{className:"bg-orange-100 text-orange-800 px-2 py-1 rounded text-sm font-medium whitespace-nowrap",children:a.code}),e.jsx("button",{onClick:()=>J(a.code),disabled:(c==null?void 0:c.code)===a.code,className:`${(c==null?void 0:c.code)===a.code?"bg-gray-400 cursor-not-allowed":"bg-orange-500 hover:bg-orange-600"} text-white py-1 px-2 rounded-md transition-colors text-sm font-medium`,children:(c==null?void 0:c.code)===a.code?"Applied":"Use"})]})]})},a._id)),k.length===0&&e.jsx("p",{className:"text-sm text-gray-600",children:"No coupons available for you right now."})]})})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 sm:gap-0 mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(oe,{className:"text-orange-500 mr-2 text-lg sm:text-xl"}),e.jsx("h2",{className:"text-base sm:text-lg font-semibold",children:"Confirm Delivery Details"})]}),e.jsxs(g.button,{onClick:()=>F({showAddresses:!Z}),className:"flex items-center text-orange-500 text-sm sm:text-base",whileHover:{scale:1.05},whileTap:{scale:.95},children:["Change",e.jsx(g.div,{animate:{rotate:Z?180:0},transition:{duration:.3},children:e.jsx(Ce,{className:"ml-1"})})]})]}),e.jsx(ie,{children:Z&&e.jsx(g.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"space-y-3 sm:space-y-4 overflow-hidden",children:e.jsxs(g.div,{className:"grid grid-cols-1 gap-3",initial:{opacity:0},animate:{opacity:1},transition:{delay:.1},children:[e.jsxs(g.button,{onClick:xe,className:`p-3 border rounded-lg cursor-pointer flex items-center transition-all duration-300 ${B?"border-orange-500 bg-orange-50 shadow-md":"border-gray-200 hover:border-orange-300 hover:shadow-sm"}`,whileTap:{scale:.98},children:[e.jsx(oe,{className:"text-orange-500 mr-2 text-lg"}),e.jsxs("div",{className:"text-left flex-1",children:[e.jsx("p",{className:"font-medium text-sm sm:text-base",children:"Use Current Location"}),e.jsx("p",{className:"text-gray-600 text-xs sm:text-sm line-clamp-2 sm:line-clamp-1",children:d||"No location available"})]})]}),(Ne=i==null?void 0:i.addresses)==null?void 0:Ne.map(a=>e.jsx(g.div,{onClick:()=>ae(a),className:`p-3 border rounded-lg cursor-pointer transition-all duration-300 ${m===a._id?"border-orange-500 bg-orange-50 shadow-md":"border-gray-200 hover:border-orange-300 hover:shadow-sm"}`,whileTap:{scale:.98},children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-gray-600 text-sm sm:text-base line-clamp-2 sm:line-clamp-1",children:a.address}),e.jsx("p",{className:"text-gray-600 text-xs sm:text-sm mt-1",children:a.phone})]})})},a._id)),e.jsx(g.button,{onClick:()=>s("/address-manage"),className:"w-full py-2 sm:py-3 text-sm sm:text-base text-orange-500 border border-orange-500 rounded-lg transition-all duration-300 hover:bg-orange-50 hover:border-orange-300 hover:shadow-sm",whileTap:{scale:.98},children:"Add New Address"})]})})}),!Z&&e.jsx(g.div,{className:"space-y-3",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm sm:text-base line-clamp-2 sm:line-clamp-1",children:R||"Please select a delivery address"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-0 mt-2",children:[e.jsx("input",{type:"text",value:b,onChange:a=>C(a.target.value),placeholder:"Enter phone number",className:"flex-1 border border-gray-200 rounded-lg px-3 py-2 text-sm sm:text-base focus:outline-none focus:border-orange-500"}),n&&e.jsx(g.button,{onClick:Y,className:"sm:ml-2 bg-orange-500 text-sm sm:text-base text-white py-2 px-3 rounded-lg hover:bg-orange-600 transition-all duration-300",whileTap:{scale:.95},children:"Use registered"})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Bill Details"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-gray-600",children:[e.jsx("span",{children:"Item Total"}),e.jsxs("span",{children:["₹",V]})]}),l>0&&e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsx("span",{children:"Offer Discount"}),e.jsxs("span",{children:["- ₹",l.toFixed(2)]})]}),c&&e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsxs("span",{children:["Coupon Discount (",c.code,")"]}),e.jsxs("span",{children:["- ₹",c.discountAmount.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-gray-600",children:[e.jsx("span",{children:"GST (5%)"}),e.jsxs("span",{children:["₹",p.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"Delivery Fee"}),N>=500&&e.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full",children:"Free Delivery"})]}),e.jsx("span",{className:"flex items-center gap-2",children:N>=500?e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-gray-400 line-through",children:["₹",S.toFixed(2)]}),e.jsx("span",{className:"text-green-600",children:"FREE"})]}):`₹${S.toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between text-gray-600",children:[e.jsx("span",{children:"Platform Fee"}),e.jsxs("span",{children:["₹",j]})]}),N<500&&e.jsxs("div",{className:"text-sm text-orange-600 bg-orange-50 p-3 rounded-lg",children:["Add items worth ₹",(500-N).toFixed(2)," more for free delivery"]}),e.jsxs("div",{className:"border-t border-gray-200 pt-3 mt-3",children:[e.jsxs("div",{className:"flex justify-between font-bold text-gray-800 text-lg",children:[e.jsx("span",{children:"To Pay"}),e.jsxs("span",{children:["₹",(N-(c?c.discountAmount:0)+p+(N>=500?0:S)+j).toFixed(2)]})]}),e.jsxs("div",{className:"mt-2 space-y-1",children:[l>0&&e.jsxs("div",{className:"text-green-600 text-sm",children:["You saved ₹",l.toFixed(2)," with offers"]}),c&&e.jsxs("div",{className:"text-green-600 text-sm",children:["You saved ₹",c.discountAmount.toFixed(2)," with coupon"]}),N>=500&&e.jsxs("div",{className:"text-green-600 text-sm",children:["You saved ₹",S.toFixed(2)," on delivery charges"]}),(l>0||c||N>=500)&&e.jsxs("div",{className:"text-green-600 text-sm font-semibold",children:["Total Savings: ₹",(l+(c?c.discountAmount:0)+(N>=500?S:0)).toFixed(2)]})]})]})]}),e.jsxs(g.button,{className:"w-full bg-orange-500 text-white rounded-lg py-3 mt-6 font-semibold hover:bg-orange-600 transition duration-300",whileHover:{scale:1.02},whileTap:{scale:.98},onClick:ze,children:["Confirm Order • ₹",(N-(c?c.discountAmount:0)+p+(N>=500?0:S)+j).toFixed(2)]}),e.jsx(ie,{children:ue&&e.jsx(qe,{isOpen:ue,onClose:()=>pe(!1),items:v.items,totalAmount:N,tax:p,platformFee:j,appliedCoupon:c,totalSavings:l+(c?c.discountAmount:0)+(N>=500?S:0),isFreeDelivery:N>=500,deliveryFee:S,offerSavings:l,selectedAddress:m||d,selectedPhoneNumber:b||n,restaurantId:A,cartId:t.data.cart._id})})]})]})};export{Is as default};
